---
title: "PSTAT 131 Homework 2"
author: "Katlyn Shaw"
date: "10/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# load packages
library(tidyverse)
library(tidymodels)
# set seed
set.seed(12345)
```




## Question 1

```{r}

# read data
abalonedf <- read.csv("abalone.csv")


# add age column
abalonedf$age <- abalonedf$rings + 1.5

# histogram
ggplot(abalonedf, aes(age)) + geom_histogram(bins=30)

# qqplot
ggplot(abalonedf) + geom_qq(aes(sample=age))

```
The distribution of age seems *approximately* normal, skewed right.

## Question 2

```{r}
# split into training and testing data

# stratified on type since type I will have lower age than M or F
abaloneSplit <- abalonedf %>%
  initial_split(prop = 0.8, strata = "type")

abaloneTrain <- training(abaloneSplit)
abaloneTest <- training(abaloneSplit)
```

## Question 3

We shouldn't use rings to predict age since you have to open (kill) the abalone to count the number of rings it has. We don't want to kill the abalone in order to predict how old it is.

Instead, we will create interactions between the other predictors to predict an abalone's age.

Since "type" is a categorical predictor, we will dummy-code for these predictors.

Then, using step_interact, we will create interactions between 
  type and shucked_weight (int1), 
  longest_shell and diameter (int2), 
  and shucked_weight and shell_weight (int3).

```{r}
abaloneAgeRecipe <-
  recipe(age ~ ., data=abaloneTrain) %>%
  step_dummy(all_nominal(), -all_outcomes()) %>% # creates dummy variables for type
  step_normalize(all_predictors(), -all_nominal()) # centers and scales all numeric predictors

int1 <- abaloneAgeRecipe %>%
  step_interact(terms = ~ starts_with("type"):shucked_weight) %>%
  step_center()

int2 <- abaloneAgeRecipe %>%
  step_interact(terms = ~ longest_shell:diameter)

int3 <- abaloneAgeRecipe %>%
  step_interact(terms = ~ shucked_weight:shell_weight)
```

## Question 4